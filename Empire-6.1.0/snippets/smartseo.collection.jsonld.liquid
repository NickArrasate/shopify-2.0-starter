{%- capture collection_json_ld %}
<!--JSON-LD data generated by Smart SEO-->
<script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "ItemList",
        "name": "{{ smartseo_title }}",
        "url": "{{ shop.url | append: collection.url }}",
        "description": "{{ smartseo_description }}",
        "image": "https:{{ collection.image | img_url: "master" }}",
        "mainEntityOfPage": {
            "@type": "CollectionPage",
            "@id": "{{ shop.url | append: collection.url }}"
        },
        "itemListElement": [
            {%- comment %}<locksmith:5bd4>{% endcomment -%}
              {%- assign locksmith_bfec_forloop__size = 0 %}{%- for product in collection.products %}{% capture var %}{% render 'locksmith-variables', scope: 'subject', subject: product, variable: 'transparent' %}{% endcapture %}{% if var == 'true' %}{% assign locksmith_bfec_forloop__size = locksmith_bfec_forloop__size | plus: 1 %}{% endif %}{% endfor %}{% assign locksmith_bfec_forloop__index = nil -%}
            {%- comment %}</locksmith:5bd4>{% endcomment -%}
            {%- for product in collection.products %}
            {%- comment %}<locksmith:96d9>{% endcomment -%}
              {%- capture var %}{% render 'locksmith-variables', scope: 'subject', subject: product, subject_parent: collection, variable: 'transparent' %}{% endcapture %}{% if var == "true" %}{% if locksmith_bfec_forloop__index == nil %}{% assign locksmith_bfec_forloop__index = 1 %}{% assign locksmith_bfec_forloop__index0 = 0 %}{% else %}{% assign locksmith_bfec_forloop__index = locksmith_bfec_forloop__index | plus: 1 %}{% assign locksmith_bfec_forloop__index0 = locksmith_bfec_forloop__index0 | plus: 1 %}{% endif %}{% if locksmith_bfec_forloop__index == 1 %}{% assign locksmith_bfec_forloop__first = true %}{% else %}{% assign locksmith_bfec_forloop__first = false %}{% endif %}{% if locksmith_bfec_forloop__index == locksmith_bfec_forloop__size %}{% assign locksmith_bfec_forloop__last = true %}{% else %}{% assign locksmith_bfec_forloop__last = false %}{% endif %}{% assign locksmith_bfec_forloop__rindex = locksmith_bfec_forloop__size | minus: locksmith_bfec_forloop__index | minus: 1 %}{% assign locksmith_bfec_forloop__rindex0 = locksmith_bfec_forloop__size | minus: locksmith_bfec_forloop__index0 | minus: 1 %}{% else %}{% continue %}{% endif -%}
            {%- comment %}</locksmith:96d9>{% endcomment -%}
            {
                "@type": "ListItem",
                "position": {{ locksmith_bfec_forloop__index }},
                "url": "{{ shop.url | append: '/products/' | append: product.handle }}"
            }{%- unless locksmith_bfec_forloop__last -%},{%- endunless -%}
            {%- endfor %}
        ]
    }
</script>
{%- endcapture %}
{{ collection_json_ld | strip_newlines | replace: '  ', '' | replace: ': ', ':' | replace: ' {', '{' }}