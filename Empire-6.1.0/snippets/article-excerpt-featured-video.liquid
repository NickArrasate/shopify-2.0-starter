{% comment %}
  @param section Object
         Required section containing settings

  @param onboarding Bool
         Triggers onboarding helper class and functionality

  @param article Object
{% endcomment %}
{% if article.excerpt contains 'vimeo' or article.excerpt contains 'youtube' %}
{% assign has_video = true %}
{% assign video_url = article.excerpt | strip %}
{% endif %}
{%- capture excerpt_class -%}
  article--excerpt-wrapper
  article--excerpt-wrapper--featured
  {% if has_video %}
  article--excerpt-wrapper--has-image
  {% elsif article.image %}
    article--excerpt-wrapper--has-image
  {% else %}
    article--excerpt-wrapper--no-image
  {% endif %}
{%- endcapture -%}

<article class="{{ excerpt_class | strip_newlines }} featured-video d-flex flex-column dynamic-video">
  {% if has_video %}
  {% render 'video-excerpt' featured: true %}
  {% elsif article.image %}
    <a
      class="article--excerpt-image"
      href="{{ article.url }}"
      tabindex="-1"
      {%
        render 'rimg',
        img: article.image,
        lazy: true,
        size: '1200x',
        crop: 'center',
        background: true
      %}
    >
      {%
        render 'rimg',
        img: article.image,
        lazy: true,
        canvas: true,
        crop: 'center',
        size: '1200x'
      %}
    </a>
  {% endif %}
  <div class="article--excerpt-content" style="right: unset;">
    {% if section.settings.show_date or section.settings.show_author %}
      <div class="article--excerpt-meta">
        {% if section.settings.show_date %}
          <span class="article--excerpt-meta-item">
            {{ article.published_at | date: format: 'month_day_year' }}
          </span>
        {% endif %}

        {% if section.settings.show_author %}
          <span class="article--excerpt-meta-item">
            {{ article.author }}
          </span>
        {% endif %}
      </div>
    {% endif %}

    <h2 class="article--excerpt-title">
      <a href="{{ article.url }}">
        {{ article.title }}
      </a>
    </h2>

    {% if article.excerpt_or_content != blank %}
      <div class="article--excerpt-text rte">
        {%- if article.excerpt contains 'vimeo' or  article.excerpt contains 'youtube' -%}
          <p>{{ article.content | strip_html | truncatewords: 10 }}</p>
          {%- elsif article.excerpt == blank -%}
            <p>{{ article.content | strip_html | truncatewords: 10 }}</p>
          {%- else -%}
            {{ article.excerpt }}
          {%- endif -%}
      </div>
    {% endif %}

    <a class="article--excerpt-readmore" href="{{ article.url }}" aria-label="read {{ article.title }}">
      Watch
    </a>
  </div>

</article>
