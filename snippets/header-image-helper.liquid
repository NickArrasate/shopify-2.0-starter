<script type="text/javascript">
    var applyImage = function (id, mobile_url, image_url ) {
        var index = id
        var image = image_url
        var mobileimage = mobile_url
        windowsize = $(window).width();
        if (windowsize < 750 && !mobileimage.includes("no-image")) {
            if ( index > 0 ){
                $(".background-target-" + index).css("background-image", "url(" + mobileimage + ")");
            } else {
                $(".background-target-" + index).css("background-image", "url(" + mobileimage + ")");
            }
        } else if (windowsize >= 750){
            var currentBG = $(".background-target-" + index).css("background-image");
            if ( index > 0 ){
                if( currentBG != image ){
                    $(".background-target-" + index).css("background-image", "url(" + image + ")");
                }
            } else {
                if( currentBG != image ){
                    $(".background-target-" + index).css("background-image", "url(" + image + ")");
                }
            }
            } else {
            var currentBG = $(".background-target-" + index).css("background-image");
            if ( index ){
                if( currentBG != image ){
                    $(".background-target-" + index).css("background-image", "url(" + image + ")");
                }
            } else {
                if( currentBG != image ){
                    $(".background-target-" + index).css("background-image", "url(" + image + ")");
                }
            }
        }
    };
    var applyTitleImage = function () {
        windowsize = $(window).width();
        if (windowsize < 992) {
            $(".titleimg").attr("src", "{{block.settings.titleimg_mobile | img_url: '500x500'}}");
        } else if (windowsize >= 992){
            $(".titleimg").attr("src", "{{block.settings.titleimg | img_url: '1800x1800' }}");
        }else {
            $(".titleimg").attr("src", "{{block.settings.titleimg | img_url: '1800x1800'}}");
        }
    }
    applyTitleImage()
    $(document).ready(function() {
        applyTitleImage()
    });
</script>
{% if metas == true %}
    <script type="text/javascript">
        console.log('metas')
        $(document).ready(function() {
            applyImage('{{block.id}}', "{{ hero_meta_image_mobile }}", "{{ hero_meta_image }}" )
        });
        $(window).resize(function() {
            applyImage('{{block.id}}', "{{ hero_meta_image_mobile }}", "{{ hero_meta_image }}" )
        });
    </script>
{% else %}
    {% for block in section.blocks %}
    <script type="text/javascript">
        console.log('non-metas')
        $(document).ready(function() {
            applyImage('{{block.id}}', "{{ block.settings.image_mobile | img_url: '1000x1000' }}", "{{ block.settings.background_image | img_url: '1800x1800' }}" )
        });
        $(window).resize(function() {
            applyImage('{{block.id}}', "{{ block.settings.image_mobile | img_url: '1000x1000' }}", "{{ block.settings.background_image | img_url: '1800x1800' }}" )
        });
    </script>
    {% endfor %}
{% endif %}
<script type="text/javascript">
    // handles the fullscreen > natural ratio switching
    // console.log('inside fullscreen-handler')
    // $(document).ready(function() {
    //     var elsToChange = $('[class*="slideshow-height"]');
    //     if (windowsize < 860) {
    //         $(elsToChange).each(function(){
    //             $( this ).removeClass (function (index, className) {
    //                 return (className.match (/(^|\s)slideshow-height-\S+/g) || []).join(' ');
    //             });
    //             $( this ).addClass ('slideshow-height-original');
    //         })
    //     }
    // });
    // $(window).resize(function() {
    //     var elsToChange = $('[class*="slideshow-height"]');
    //     var originalHeight = $('#slideshow-data-outer').attr('data-slideHeight');
    //     if (windowsize < 860) {
    //         $(elsToChange).each(function(){
    //             $( this ).removeClass (function (index, className) {
    //                 return (className.match (/(^|\s)slideshow-height-\S+/g) || []).join(' ');
    //             });
    //             $( this ).addClass ('slideshow-height-original');
    //         })
    //     } else {
    //         $(elsToChange).each(function(){
    //             $( this ).addClass ('slideshow-height-' + originalHeight);
    //             $( this ).removeClass ('slideshow-height-original');
    //         })
    //     }
    // });
    $('#hero-mobile-header').on('touchstart', function(event){
        const xClick = event.originalEvent.touches[0].pageX;
        $(this).one('touchmove', function(event){
            const xMove = event.originalEvent.touches[0].pageX;
            const sensitivityInPx = 5;

            if( Math.floor(xClick - xMove) > sensitivityInPx ){
                $(this).carousel('next');
            }
            else if( Math.floor(xClick - xMove) < -sensitivityInPx ){
                $(this).carousel('prev');
            }
        });
        $(this).on('touchend', function(){
            $(this).off('touchmove');
        });
    });
</script>