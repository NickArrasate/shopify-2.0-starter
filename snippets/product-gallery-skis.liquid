{% for tag in product.tags %}
 {% if tag contains 'new' %}
 {% assign productNew = true %}
{% endif %}
{% endfor %}
{%- capture classes -%}
  product-gallery--slider
  {% if product.images.size > 0 %}
    product-gallery--has-images
    product-gallery--style-tall
  {% endif %}
  {% if productNew %}
    has-new-badge
  {% endif %}
{%- endcapture -%}

<div
  class="{{ classes | strip_newlines }}"
  data-product-slider
  aria-label="{{ product.title }} image. Click or Scroll to Zoom."
>
<div class="mobile-gallery-control-left">
  <button id="gallery-prev-mobile" class="gallery-nav-button"><div><p style="margin:0;">&lsaquo;</p></div></button>
</div>
{% render 'product-new-sale-badges' %}
{% render 'click-to-zoom' %}
  {% if product.images.size > 0 %}
    {% for image in product.images %}
      {% assign is_video = false %}
      {%
        if image.alt contains 'vimeo'
        or image.alt contains 'youtube'
        or image.alt contains 'youtu.be'
      %}
        {% assign is_video = true %}
      {% endif %}
      <figure
        class="
          product-gallery--image
          {% if selected_image == image %}
          image--selected
          {% endif %}
        "
        data-product-image="{{ image.id }}"
        data-product-image-index="{{ forloop.index0 }}"
        {% if is_video %}
          data-product-image-video
        {% else %}
          data-product-image-zoom
        {% endif %}
        tabindex="-1"
        {% if selected_image != image %}
          aria-hidden="true"
        {% endif %}
      >
        <div
          class="product-galley--image-background"
          {% if settings.product_slideshow_style contains 'cropped' and is_video == false %}
            {%
              render 'rimg',
              img: image,
              size: 'x1800',
              lazy: true,
              background: true,
              crop: 'center'
            %}
          {% endif %}
        >
        <a href="#zoomModal_{{forloop.index}}" data-toggle="modal">
          {% if is_video %}
            <div class="product-galley--video-container">
              {%
                render 'video',
                slideshow: true,
                url: image.alt,
                aspect_ratio: '16-9',
              %}
              {%
                render 'rimg',
                img: image,
                class: 'product-gallery--video-image'
                size: '1800x1800',
                lazy: true,
                canvas: true
              %}
            </div>
          {% else %}
            {% if settings.enable_image_zoom %}
              <div class="product-galley--zoom-instructions">
                <div class="product-galley--instruction click">
                  {% render 'icon-library', id: 'icon-zoom' %}
                  {{ 'product.general.zoom' | t }}
                </div>

                <div class="product-galley--instruction tap">
                  {% render 'icon-library', id: 'icon-tap' %}
                  {{ 'product.general.zoomTap' | t }}
                </div>
                  <div class="product-galley--instruction mobile">
                    {% render 'icon-library', id: 'icon-tap' %}
                    {{ 'product.general.zoomTapMobile' | t }}
                  </div>
              </div>
            {% endif %}
            {%
              render 'rimg',
              img: image,
              class: 'product-gallery--video-image img-zoomable'
              size: '1800x1800',
              lazy: true,
              canvas: false
            %}
          {% endif %}
        </a>
        </div>

      </figure>

    {% render 'product-zoom-modal' %}
    {% endfor %}
  {% else %}
    <figure class="product-gallery--image product-gallery--image-placeholder">
      {% unless onboarding %}
        {{ 'image' | placeholder_svg_tag: 'placeholder--image' }}
      {% else %}
        {{ 'product-1' | placeholder_svg_tag: 'placeholder--image' }}
      {% endunless %}
    </figure>
  {% endif %}
  <div class=" mobile-gallery-control-right">
    <button id="gallery-next-mobile" class="gallery-nav-button"><div><p style="margin:0;">&rsaquo;</p></div></button>
  </div>
</div>

{% if product.images.size > 1 %}
<div class="gallery-nav-wrap d-flex align-items-end">
<button id="gallery-prev" class="gallery-nav-button"><div><p style="margin:0;">&lsaquo;</p></div></button>
  <div
    class="product-gallery--navigation {% if template contains 'ski' or template contains 'art'%}skis {% endif %}"
    data-product-slider-pagination
    aria-label="{{ 'general.accessibility.nav_product_thumbnails' | t }}"
  >

    {% for image in product.images %}
      {% assign is_video = false %}

      {% if image.alt != blank %}
        {% if image.alt contains 'vimeo' or image.alt contains 'youtube' %}
          {% assign is_video = true %}
        {% endif %}
      {% endif %}

      <button
        class="product-gallery--thumbnail-trigger {% if template contains 'ski' or template contains 'art'%}skis {% endif %}{% if selected_image == image %}thumbnail--selected{% endif %}"
        data-product-thumbnail="{{ forloop.index0 }}"
        type="button"
      >
        <span class="product-gallery--thumbnail-span" tabindex="-1">
          {% if is_video %}
            {% render 'icon-library', id: 'icon-play' %}
            {%
              render 'rimg',
              class: 'product-gallery--thumbnail',
              img: image,
              size: 'x120',
              alt: 'Product video thumbnail',
            %}
          {% else %}
            {%
              render 'rimg',
              class: 'product-gallery--thumbnail',
              img: image,
              size: 'x120',
            %}
          {% endif %}
        </span>
      </button>
    {% endfor %}

  </div>
  <button id="gallery-next" class="gallery-nav-button"><div><p style="margin:0;">&rsaquo;</p></div></button>
</div>
{% endif %}
<!--
{% if product.images.size > 0 %}
  <div
    class="product-gallery--overlay"
    data-pixelzoom-overlay
  >
    <div
      class="product-gallery--overlay-container"
      data-pixelzoom-overlay-container
    >
      {%
        render 'rimg',
        img: product.images[0],
        size: '1800x1000',
        lazy: true,
        canvas: true
      %}
    </div>
  </div>
{% endif %} -->
